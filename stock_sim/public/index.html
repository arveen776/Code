<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Trading Simulator</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://unpkg.com/chartjs-chart-financial@0.2.1/dist/chartjs-chart-financial.min.js"></script>
    <script>
        // Verify financial chart type is available after scripts load
        window.addEventListener('load', function() {
            setTimeout(function() {
                if (typeof Chart !== 'undefined') {
                    if (Chart.registry && Chart.registry.controllers) {
                        const chartTypes = Object.keys(Chart.registry.controllers);
                        if (chartTypes.includes('candlestick')) {
                            console.log('✅ Candlestick chart type is available');
                        } else {
                            console.warn('⚠️ Candlestick chart type not found. Available types:', chartTypes);
                            console.warn('Trying to manually register...');
                        }
                    } else {
                        console.warn('⚠️ Chart.registry.controllers not available');
                    }
                } else {
                    console.error('❌ Chart.js not loaded');
                }
            }, 100);
        });
    </script>
    <script src="https://cdn.socket.io/4.6.1/socket.io.min.js"></script>
</head>
<body>
    <div class="container">
        <header class="app-header">
            <div class="header-left">
                <h1 class="app-title">Stock Simulator</h1>
                <div class="symbol-display">
                    <span id="headerSymbol">--</span>
                    <span id="headerPrice" class="price-display">$0.00</span>
                    <span id="headerChange" class="change-display">+0.00 (0.00%)</span>
                </div>
            </div>
            <div class="header-right">
                <div class="portfolio-summary">
                    <div class="summary-item">
                        <span class="label">Cash</span>
                        <span id="headerCash" class="value">$10,000.00</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">Total</span>
                        <span id="headerTotal" class="value">$10,000.00</span>
                    </div>
                </div>
            </div>
        </header>

        <div class="main-content">
            <div class="chart-section">
                <div class="chart-header">
                    <div class="symbol-selector">
                        <div class="search-container">
                            <input type="text" id="chartSymbol" class="symbol-input" placeholder="Search stock symbol..." autocomplete="off">
                            <div id="searchResults" class="search-results"></div>
                        </div>
                    </div>
                    <div class="timeframe-selector">
                        <button class="timeframe-btn" data-timeframe="1">1m</button>
                        <button class="timeframe-btn" data-timeframe="5">5m</button>
                        <button class="timeframe-btn" data-timeframe="15">15m</button>
                        <button class="timeframe-btn" data-timeframe="30">30m</button>
                        <button class="timeframe-btn" data-timeframe="60">1H</button>
                        <button class="timeframe-btn active" data-timeframe="1D">1D</button>
                        <button class="timeframe-btn" data-timeframe="1W">1W</button>
                        <button class="timeframe-btn" data-timeframe="1M">1M</button>
                        <button class="timeframe-btn" data-timeframe="3M">3M</button>
                        <button class="timeframe-btn" data-timeframe="6M">6M</button>
                        <button class="timeframe-btn" data-timeframe="1Y">1Y</button>
                    </div>
                    <div class="chart-actions">
                        <input type="date" id="historicalDate" class="date-input">
                        <button id="viewHistoricalBtn" class="action-btn">Historical</button>
                        <button id="viewLiveBtn" class="action-btn active">Live</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="stockChart"></canvas>
                </div>
                <div class="chart-stats">
                    <div id="chartInfo"></div>
                </div>
            </div>

            <div class="sidebar">
                <div class="trading-panel">
                    <h3 class="panel-title">Order</h3>
                    <div class="trade-form">
                        <div class="form-group">
                            <label>Symbol</label>
                            <div class="search-container">
                                <input type="text" id="symbolSelect" class="form-input" placeholder="Search stock symbol..." autocomplete="off">
                                <div id="tradeSearchResults" class="search-results"></div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Quantity</label>
                            <input type="number" id="quantityInput" class="form-input" placeholder="0" min="1">
                        </div>
                        <div class="price-info">
                            <div class="price-row">
                                <span>Price</span>
                                <span id="currentPrice" class="price-value">$0.00</span>
                            </div>
                            <div class="price-row">
                                <span>Total</span>
                                <span id="tradeTotal" class="price-value">$0.00</span>
                            </div>
                        </div>
                        <div class="trade-buttons">
                            <button id="buyBtn" class="btn btn-buy">Buy</button>
                            <button id="sellBtn" class="btn btn-sell">Sell</button>
                        </div>
                    </div>
                </div>

                <div class="portfolio-panel">
                    <h3 class="panel-title">Portfolio</h3>
                    <div class="portfolio-stats">
                        <div class="stat-item">
                            <span class="stat-label">Cash</span>
                            <span id="cash" class="stat-value">$10,000.00</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Total Value</span>
                            <span id="totalValue" class="stat-value">$10,000.00</span>
                        </div>
                    </div>
                    <div class="holdings">
                        <h4 class="holdings-title">Holdings</h4>
                        <div id="holdingsList" class="holdings-list"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>

